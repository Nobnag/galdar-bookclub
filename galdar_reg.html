<!DOCTYPE html>
<html>
    <head>
        <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
        <link rel="stylesheet" type="text/css" href="css/gnb.css" />
        <link rel="stylesheet" href="css/galdar_reg.css">
        <link rel="stylesheet" type="text/css" href="css/footer.css" />
        <script src="js/gnb.js"></script>
        <script src="js/footer.js"></script>
        <title>도서등록페이지 </title>
        <script>
            /* const reader = new FileReader();
    
            reader.onload = (readerEvent) => {     //onload 이벤트는 읽기 동작이 성공적으로 완료 되었을 때마다 발생한다.
                document.querySelector(".real-upload").setAttribute("src", readerEvent.target.result);
            };
    
            document.querySelector("#upload_file").addEventListener("change", (changeEvent) => {
    
                const imgFile = changeEvent.target.files[0];
                reader.readAsDataURL(imgFile);
    
                const fileName = document.getElementById("file_route");
                fileName.value = imgFile.name;
                //파일 이름을 띄워줌
            }) */
            $(document).ready(function(){
                $('.content_write').click(function(){
                    var BookCategory = $('input[name="BookCategory"]').val().trim();
                    var BookTitle = $('input[name="BookTitle"]').val().trim();
                    var BookDesc = $('input[name="BookDesc"]').val().trim();
                    var BookAuthor = $('input[name="BookAuthor"]').val().trim();
                    var BookTranslator = $('input[name="BookTranslator"]').val().trim();
                    var BookPublisher = $('input[name="BookPublisher"]').val().trim();
                    var BookPubDate = $('input[name="BookPubDate"]').val().trim();
                    var BookBtDate = $('input[name="BookBtDate"]').val().trim();
                    var BookRegWriter = $('input[name="BookRegWriter"]').val().trim();
                    // var upload_file = $('input[name="upload_file"]').val();

                    if(BookCategory == ""){
                        alert("도서분야를 입력해주세요");
                        return false;
                    }
                    if(BookTitle == ""){
                        alert("도서제목을 입력해주세요");
                        return false;
                    }
                    if(BookDesc == ""){
                        alert("도서설명을 입력해주세요");
                        return false;
                    }
                    if(BookAuthor == ""){
                        alert("도서저자를 입력해주세요");
                        return false;
                    }
                    /* if(BookTranslator == ""){
                        alert("도서옮긴이를 입력해주세요");
                        return false;
                    } */
                    if(BookPublisher == ""){
                        alert("도서출판사를 입력해주세요");
                        return false;
                    }
                    if(BookPubDate == ""){
                        alert("도서출판일자를 입력해주세요");
                        return false;
                    }
                    if(BookBtDate == ""){
                        alert("북토크일자를 입력해주세요");
                        return false;
                    }
                    if(BookRegWriter == ""){
                        alert("작성자명을 입력해주세요");
                        return false;
                    }
                    /* var fileCheck = document.getElementById("upload_file").value;
                        if(!fileCheck){
                            alert("파일을 첨부해 주세요");
                            return false;
                        }
                    */
                    if(BookTitle !== "" && BookAuthor !== "" && BookPublisher !== "" && BookPubDate!== "" && BookBtDate !== "" && BookCategory !== "" && BookRegWriter !== "" && BookDesc !== ""){
                        var params = {
                            BookTitle: BookTitle,
                            BookAuthor: BookAuthor,
                            BookPublisher: BookPublisher,
                            BookTranslator: BookTranslator,
                            BookPubDate: BookPubDate,
                            BookBtDate: BookBtDate,
                            BookCategory: BookCategory,
                            BookRegWriter: BookRegWriter,
                            BookDesc: BookDesc
                        };

                        $.ajax({
                            url: '/api/createBook'
                            ,data: params
                            ,type: 'post' 
                            ,datatype: 'json'
                            ,success: function(result){
                                if(result.recordset.length > 0){
                                alert('도서가 등록되었습니다.');
                                location.href=('/galdar_list');
                                }
                            },
                            error: function(jqXHR, textStatus, errorThrown){
                                console.log(errorThrown);
                            }
                        });
                    }
                        /* else {
                            var result = confirm("게시글을 등록하시겠습니까?" );
                            if(result == 0) return false;
                            else alert("등록되었습니다.");
                            location.href = "./galdar_list.html"; 
                        }   */  
                });
            });
        </script>

    </head>
    <body>
        <div class="reg_wrapper">
            <div class="image_update">
                <input type="image" class="real-upload">
                <div class="file_upload_botton">
                    <!-- <p>이미지는 --- --- 로 등록하세요</p> -->
                    <input type="text" id="file_route" disabled="disabled" value="파일 선택">
                    <label for="upload_file">이미지 업로드</label>
                    <input type="file" id="upload_file" class="upload_file" accept="image/*" required=true 
                    style="position:absolute; clip:rect(0, 0, 0, 0);">
                </div>
            </div>

            <div class="input_content">
                <b class="name">도서분야</b>
                <input class="text" type="text" name="BookCategory" placeholder="도서 분야를 입력하세요."><br><br>

                <b class="name">도서제목</b>
                <input class="text" type="text" name="BookTitle" placeholder="도서 제목을 입력하세요."><br><br>
                <!-- 확인필요 -->
                <b class="name">도서설명</b>
                <input class="text" type="text" name="BookDesc" placeholder="도서 설명을 입력하세요."><br><br>

                <b class="name">도서저자</b>
                <input class="text" type="text" name="BookAuthor" placeholder="도서 저자를 입력하세요."><br><br>

                <b class="name">도서옮긴이</b>
                <input class="text" type="text" name="BookTranslator" placeholder="도서 옮긴이를 입력하세요."><br><br>

                <b class="name">도서출판사</b>
                <input class="text" type="text" name="BookPublisher" placeholder="도서 출판사를 입력하세요."><br><br>

                <b class="name">도서출판일자</b>
                <input class="text" type="text" name="BookPubDate" placeholder="도서 출판일자를 입력하세요."><br><br>

                <b class="name">북토크일자</b>
                <input class="text" type="text" name="BookBtDate" placeholder="북토크 일자를 입력하세요."><br><br>

                <b class="name">작성자</b>
                <input class="text" type="text" name="BookRegWriter"><br><br>
                <button class="content_write">글쓰기</button>
            </div>
        </div>

        
    </body>
</html>
